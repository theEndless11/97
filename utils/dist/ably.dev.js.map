{"version":3,"sources":["ably.js"],"names":["ably","Ably","Realtime","process","env","ABLY_API_KEY","channel","channels","get","publishToAbly","event","data","Promise","resolve","reject","serializedData","timestamp","Date","toISOString","publish","err","console","error","log","subscribeToAbly","callback","subscribe","message"],"mappings":";;;;;;;;AAAA;;;;;;;;;;AAEA,IAAMA,IAAI,GAAG,IAAIC,iBAAKC,QAAT,CAAkBC,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAb,C,CAA2D;;AAC3D,IAAMC,OAAO,GAAGN,IAAI,CAACO,QAAL,CAAcC,GAAd,CAAkB,UAAlB,CAAhB,C,CAAgD;;AAEhD;;;;;;AAKO,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,IAA9B,EAAoC;AACvC,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC;AACA,QAAMC,cAAc,qBACbJ,IADa;AAEhBK,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EAFK,CAEsB;;AAFtB,MAApB,CAFoC,CAOpC;;;AACAZ,IAAAA,OAAO,CAACa,OAAR,CAAgBT,KAAhB,EAAuBK,cAAvB,EAAuC,UAACK,GAAD,EAAS;AAC5C,UAAIA,GAAJ,EAAS;AACLC,QAAAA,OAAO,CAACC,KAAR,CAAc,mCAAd,EAAmDF,GAAnD;AACAN,QAAAA,MAAM,CAACM,GAAD,CAAN;AACH,OAHD,MAGO;AACHC,QAAAA,OAAO,CAACE,GAAR,yDAA6Db,KAA7D;AACAG,QAAAA,OAAO;AACV;AACJ,KARD;AASH,GAjBM,CAAP;AAkBH;AAED;;;;;;;AAKO,SAASW,eAAT,CAAyBd,KAAzB,EAAgCe,QAAhC,EAA0C;AAC7CnB,EAAAA,OAAO,CAACoB,SAAR,CAAkBhB,KAAlB,EAAyB,UAACiB,OAAD,EAAa;AAClCN,IAAAA,OAAO,CAACE,GAAR,2BAA+Bb,KAA/B,GAAwCiB,OAAxC;AACAF,IAAAA,QAAQ,CAACE,OAAD,CAAR;AACH,GAHD;AAIH","sourcesContent":["import Ably from 'ably';\r\n\r\nconst ably = new Ably.Realtime(process.env.ABLY_API_KEY);  // Fetch Ably API key from environment variables\r\nconst channel = ably.channels.get('opinions');  // Use the same 'opinions' channel for all communication\r\n\r\n/**\r\n * Publish a message to the Ably channel\r\n * @param {string} event - The event name, e.g., 'newOpinion', 'editOpinion', or 'deleteOpinion'\r\n * @param {Object} data - The data to send in the event\r\n */\r\nexport function publishToAbly(event, data) {\r\n    return new Promise((resolve, reject) => {\r\n        // Serialize the data if needed\r\n        const serializedData = {\r\n            ...data,\r\n            timestamp: new Date().toISOString(),  // Add current timestamp\r\n        };\r\n\r\n        // Publish the event with the serialized data\r\n        channel.publish(event, serializedData, (err) => {\r\n            if (err) {\r\n                console.error('Error publishing message to Ably:', err);\r\n                reject(err);\r\n            } else {\r\n                console.log(`Published message to Ably channel with event: ${event}`);\r\n                resolve();\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Subscribe to an event on the Ably channel\r\n * @param {string} event - The event name to subscribe to\r\n * @param {Function} callback - The callback function to handle the event\r\n */\r\nexport function subscribeToAbly(event, callback) {\r\n    channel.subscribe(event, (message) => {\r\n        console.log(`Received event: ${event}`, message);\r\n        callback(message);\r\n    });\r\n}"],"file":"ably.dev.js"}